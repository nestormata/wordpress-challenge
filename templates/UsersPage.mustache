<script type="module">
import { h, html, render, signal, createContext } from 'https://cdn.jsdelivr.net/npm/preact-htm-signals-standalone/dist/standalone.js';
import { App } from '{{ base_path }}assets/js/App.js';
import { createAppState } from '{{ base_path }}assets/js/AppState.js';

const  tpl = html.bind(h);

const AppState = createContext();
const state = createAppState();

async function loadUsersData() {
    const response = await fetch(challenge.ajaxurl + "?" + new URLSearchParams({
        action: "challenge_users"
    }), {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
        }
    });
    return response.json();
}
loadUsersData().then(data => state.users.value = data);

render(tpl`
    <AppState.Provider value=${state}>
        <${App} state="${state}" />
    </AppState.Provider>
`, document.getElementById('app'));
</script>

<div id="app"></div>